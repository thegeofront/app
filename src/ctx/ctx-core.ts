// TODO: do the whole core thing again